jQuery.sap.registerPreloadedModules({version:"2.0",modules:{"com/mjzsoft/Survey/Component.js":function(){sap.ui.define(["sap/ui/core/UIComponent","sap/ui/Device","./model/models","./controller/ErrorHandler","./config/env","./js/jwtAuthApp"],function(e,t,n,r,s,o){"use strict";return e.extend("com.mjzsoft.Survey.Component",{metadata:{manifest:"json"},init:function(){e.prototype.init.apply(this,arguments);this._oErrorHandler=new r(this);this.setModel(n.createDeviceModel(),"device");o.addModel(this.getModel());this.getRouter().initialize()},getCurrentUser:function(){return o.getCurrentUser()},destroy:function(){this._oErrorHandler.destroy();e.prototype.destroy.apply(this,arguments)},getContentDensityClass:function(){if(this._sContentDensityClass===undefined){if(document.body.classList.contains("sapUiSizeCozy")||document.body.classList.contains("sapUiSizeCompact")){this._sContentDensityClass=""}else if(!t.support.touch){this._sContentDensityClass="sapUiSizeCompact"}else{this._sContentDensityClass="sapUiSizeCozy"}}return this._sContentDensityClass}})})},"com/mjzsoft/Survey/config/env.js":function(){sap.ui.define(["sap/ui/model/json/JSONModel","sap/base/Log"],function(e,t){"use strict";var n=window.location.href,r=n.includes("hana.ondemand.com/")?true:false,s=jQuery.sap.storage(jQuery.sap.storage.Type.local),o=function(){if(r){try{var n=jQuery.sap.storage(jQuery.sap.storage.Type.session);var s=jQuery.sap.getModulePath("com.mjzsoft.Survey","/config/token.json");var o=new e(s);o.attachRequestCompleted(null,function(){var e=o.getData();var t={accessToken:e.accessToken,refreshToken:e.refreshToken,tokenType:e.tokenType,expireAt:(new Date).getTime()+e.expiryDuration};n.put("CurrentToken",JSON.stringify(t))})}catch(e){t.error(e)}}};var i;if(r){i="http://localhost"}else{i=window.location.href;i=i.substring(0,i.indexOf("?"));i=i.substring(0,i.lastIndexOf("/"))}s.put("JwtServerUrl",i+"/");s.put("JwtUserEndpoint","api/user/me");o();return{isDebugModeActivated:function(){return r}}})},"com/mjzsoft/Survey/control/InfiniteWizard.js":function(){sap.ui.define(["sap/m/Wizard"],function(e){"use strict";return e.extend("com.mjzsoft.Survey.control.InfiniteWizard",{renderer:{},_isMaxStepCountExceeded:function(){var e=this._getStepCount();if(this.getEnableBranching()){return false}return e>=1e3},_isMinStepCountReached:function(){var e=this._getStepCount();return e>=1}})})},"com/mjzsoft/Survey/controller/App.controller.js":function(){sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel"],function(e,t){"use strict";return e.extend("com.mjzsoft.Survey.controller.App",{onInit:function(){var e,n;e=new t({busy:true,delay:0});this.setModel(e,"appView");n=function(){e.setProperty("/busy",false);e.setProperty("/delay",0)};this.getOwnerComponent().getModel().metadataLoaded().then(n);this.getOwnerComponent().getModel().attachMetadataFailed(n);this.getView().addStyleClass(this.getOwnerComponent().getContentDensityClass())}})})},"com/mjzsoft/Survey/controller/BaseController.js":function(){sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/UIComponent","sap/m/library"],function(e,t,n){"use strict";return e.extend("com.mjzsoft.Survey.controller.BaseController",{getRouter:function(){return t.getRouterFor(this)},getModel:function(e){return this.getView().getModel(e)},setModel:function(e,t){return this.getView().setModel(e,t)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},startAppBusy:function(){this.getModel("appView").setProperty("/busy",true)},stopAppBusy:function(){this.getModel("appView").setProperty("/busy",false)}})})},"com/mjzsoft/Survey/controller/ErrorHandler.js":function(){sap.ui.define(["sap/ui/base/Object","sap/m/MessageBox","../js/XML2JSON"],function(e,t,n){"use strict";return e.extend("com.mjzsoft.Survey.controller.ErrorHandler",{constructor:function(e){this._oResourceBundle=e.getModel("i18n").getResourceBundle();this._oComponent=e;this._oModel=e.getModel();this._bMessageOpen=false;this._sErrorText=this._oResourceBundle.getText("errorText");this._oModel.attachMetadataFailed(function(e){var t=e.getParameters();this._showServiceError(t.response)},this);this._oModel.attachRequestFailed(function(e){var t=e.getParameters();if(t.response.statusCode!=="404"||t.response.statusCode===404&&t.response.responseText.indexOf("Cannot POST")===0){this._showServiceError(t.response)}},this)},_showServiceError:function(e){if(this._bMessageOpen){return}try{var r=JSON.parse(e.responseText);try{var s=r.error.innererror.errordetails,o=e.statusText+" ("+e.statusCode+") <br/>";for(var i=0;i<s.length;i++){o+="<br/> Code("+s[i].code+") : "+s[i].message}if(s.length===0){o+=r.error.message.value}var a=r.error.innererror.Error_Resolution;if(a&&a.SAP_Transaction){o+="<br/>"+a.SAP_Transaction}}catch(t){o=e.statusText+" ("+e.statusCode+") <br/>"+r.error.message.value}}catch(t){try{var u=new n.X2JS;r=u.XMLStr2JSON(e.responseText);o=e.statusText+" ("+e.statusCode+") \n\n"+r.error.message.__text;o+="<br/><br/>"+r.error.innererror.Error_Resolution.SAP_Transaction}catch(t){o=e.statusText+" ("+e.statusCode+") \n\n"+e.responseText}}this._bMessageOpen=true;var l=parseInt(e.statusCode,10);if(l<500&&l>=400){t.error(this._oResourceBundle.getText("error400TypeResponse"),{id:"serviceErrorMessageBox",details:o?o:e,icon:sap.m.MessageBox.Icon.WARNING,styleClass:this._oComponent.getContentDensityClass(),actions:[t.Action.CLOSE],onClose:function(){this._bMessageOpen=false}.bind(this)})}else{t.error(this._oResourceBundle.getText("errorResponse"),{id:"serviceErrorMessageBox",details:o?o:e,icon:sap.m.MessageBox.Icon.WARNING,styleClass:this._oComponent.getContentDensityClass(),actions:[t.Action.CLOSE],onClose:function(){this._bMessageOpen=false}.bind(this)})}}})})},"com/mjzsoft/Survey/controller/NotFound.controller.js":function(){sap.ui.define(["./BaseController"],function(e){"use strict";return e.extend("com.mjzsoft.Survey.controller.NotFound",{onLinkPressed:function(){this.getRouter().navTo("worklist")}})})},"com/mjzsoft/Survey/controller/Object.controller.js":function(){sap.ui.define(["./BaseController","../model/formatter","../utils/Utils","../utils/ControlHelper","../control/InfiniteWizard","sap/ui/core/routing/History","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/ValueState","sap/ui/core/CustomData","sap/ui/core/Item","sap/m/MessageToast","sap/m/RadioButtonGroup","sap/m/VBox","sap/m/WizardStep"],function(e,t,n,r,s,o,i,a,u,l,d,c,f,p,h,g){"use strict";const m={_RATINGINDICATOR:"sap.m.RatingIndicator",_SWITCH:"sap.m.Switch",_RADIOBUTTON:"sap.m.RadioButton",_CHECKBOX:"sap.m.CheckBox",_INPUT:"sap.m.Input",_TEXTAREA:"sap.m.TextArea",_SELECT:"sap.m.Select"};return e.extend("com.mjzsoft.Survey.controller.Object",{formatter:t,onInit:function(){this._oDataModel=[];this._aFinishedQuestions=[];this._initViewModel();this.getRouter().getRoute("object").attachPatternMatched(this._onObjectMatched,this)},onNavBack:function(){var e=o.getInstance().getPreviousHash();if(e!==undefined){history.go(-1)}else{this._navToWorkList()}},onPressCompleteWizard:function(e){var t=this.getResourceBundle();n.showDialog(this,t.getText("titleSaveDialog"),l.Warning,t.getText("txtDialogAdd"),this._collectWizardData.bind(this),true,t.getText("btnYes"),true,t.getText("btnNo"),true)},_collectWizardData:function(){var e=this._getWizardFields(),t=[];for(var n=0;n<e.length;n++){var r=e[n],s=r.getAggregation("customData");for(var o=0;o<this._oDataModel.length;o++){var i=s[0].getProperty("value"),a=this._oDataModel[o],u=r.getMetadata().getName();if(i!==a.QuestionId){continue}if(a.M){t.push(this._generateOptionObject(s[1].getProperty("value"),i,true));continue}switch(u){case m._INPUT:a.Answer=r.getProperty("value");t.push(a);break;case m._TEXTAREA:a.Answer=r.getProperty("value");t.push(a);break;case m._RATINGINDICATOR:a.Answer=String(r.getProperty("value"));t.push(a);break;case m._SWITCH:if(r.getProperty("state")){a.Answer="1"}else{a.Answer="0"}t.push(a);break;case m._RADIOBUTTON:if(r.getProperty("selected")){a.OptionId=s[1].getProperty("value");t.push(a)}break;case m._SELECT:if(r.getSelectedItem().getProperty("key")){a.OptionId=parseInt(r.getSelectedItem().getProperty("key"),10);t.push(a)}break;case m._CHECKBOX:if(r.getProperty("selected")){a.OptionId=s[1].getProperty("value");t.push(a)}break}}}this._preprocressDataAndSave(t)},onLiveChangeRatingIndicator:function(e){this._oWizard.setShowNextButton(true)},onCompleteStepInWizard:function(e){var t=e.getSource().getTitle(),n,r=-1,s;for(var o=0;o<this._aQuestions.length&&r<0;o++){if(this._aQuestions[o].Question===t){r=o+1;n=this._aQuestions[r]}}if(!n){return}s=n.Qtype.Ui5Class;if(n.Mandatory){if(s===m._SWITCH||s===m._RATINGINDICATOR){this._oWizard.setShowNextButton(true);return}this.checkShowNextButton(s,r);return}this._oWizard.setShowNextButton(true)},checkShowNextButton:function(e,t){var n=this._oWizard.getSteps()[t],r=n.getAggregation("content")[0],s=e===m._RADIOBUTTON?r.getButtons():r.getItems();this._oWizard.setShowNextButton(false);for(var o=0;o<s.length;o++){if(this._isControlHavingValue(s[o],e)){this._oWizard.setShowNextButton(true);break}}},onLiveChangeInput:function(e){var t=e.getSource();if(e.getParameters().newValue.length>2){this._oWizard.setShowNextButton(true);t.setValueState(l.None)}else{this._oWizard.setShowNextButton(false);t.setValueStateText(this.getResourceBundle().getText("txtValueState"));t.setValueState(l.Error)}},onSelectCheckBox:function(e){var t=e.getSource().getParent(),n;if(t){n=t.getItems();for(var r=0;r<n.length;r++){if(n[r].getSelected()){this._oWizard.setShowNextButton(true);return}else{this._oWizard.setShowNextButton(false)}}}},onSelectRadioButton:function(e){var t=e.getSource().getParent(),n;if(t){n=t.getButtons();for(var r=0;r<n.length;r++){if(n[r].getSelected()){this._oWizard.setShowNextButton(true);return}else{this._oWizard.setShowNextButton(false)}}}},_onObjectMatched:function(e){var t=e.getParameter("arguments"),n=t.objectId,r=this.getModel(),s;this._resetViewModelAndLocalData(t);this._destroyWizardFromPreviousSurvey();this.startAppBusy();r.metadataLoaded().then(()=>{s=this.getModel().createKey("SurveySet",{Id:this._sUserSurveyID});this._bindView("/"+s);this._readQuestionsSet(n)})},_initViewModel:function(){this._oViewModel=this._initObjectViewModel();this.setModel(this._oViewModel,"viewModel")},_initObjectViewModel:function(){return new i({userName:"",submitVisible:true,userID:"",icon:"",titState:l.None,isSurveyFinished:false,FilteredQuestions:[],PossibleAnswers:[],UserAnswers:[]})},_resetViewModelAndLocalData:function(e){this._oViewModel.setProperty("/isSurveyFinished",e.finished==="1"?true:false);this._oViewModel.setProperty("/userID",e.userID);this._oViewModel.setProperty("/FilteredQuestions",[]);this._oViewModel.setProperty("/PossibleAnswers",[]);this._oViewModel.setProperty("/UserAnswers",[]);this._aFinishedQuestions=[];this._sUserSurveyID=e.sUserSurveyID},_destroyWizardFromPreviousSurvey:function(){var e=this.byId("idVerticalLayout").getContent();if(e.length>1){if(e[1].getMetadata().getName()==="sap.m.Wizard"){e[1].destroy()}}},_getWizardFields:function(){var e=r.getRelevantFields(sap.ui.getCore().byFieldGroupId("fieldGroupSurvey")),t=[],n;for(var s=0;s<e.length;s++){n=e[s].getMetadata().getName();if(n===m._CHECKBOX){if(e[s].getSelected()){t.push(e[s])}}else{t.push(e[s])}}return t},_generateOptionObject:function(e,t,n){var r={Answer:"",OptionId:!e?"":e,QuestionId:t,M:n,UserId:this._oViewModel.getProperty("/userID")};return r},_preprocressDataAndSave:function(e){this.startAppBusy();var t=this.getModel(),n="mjzsoftadd1"+(new Date).getTime(),r=function(){if(this.iNumberOfDoneRequests===0){this.stopAppBusy();this.getModel().setDeferredGroups(["changes"]);this._updateUserSurvey()}}.bind(this);t.setUseBatch(true);t.setDeferredGroups([n]);this.iNumberOfDoneRequests=0;for(var s=0;s<e.length;s++){var o=e[s];delete o.M;if(o.OptionId===""){delete o.OptionId}this.iNumberOfDoneRequests++;this._saveAnswerForQuestion(o,n,r)}t.submitChanges({groupId:n})},_saveAnswerForQuestion:function(e,t,n){var r=this.getModel();r.create("/AnswerSet",e,{groupId:t,success:(e,t)=>{this.iNumberOfDoneRequests--;if(typeof n==="function"){n(e,t)}},error:e=>{this.iNumberOfDoneRequests--;if(typeof n==="function"){n(e)}}})},_updateUserSurvey:function(){this.startAppBusy();var e={DoneAt:new Date},t=this.getModel(),n="/"+t.createKey("SurveySet",{Id:this._sUserSurveyID});t.setDeferredGroups(["changes"]);t.update(n,e,{success:()=>{this._oWizard.destroy();f.show(this.getResourceBundle().getText("Success"));this._navToWorkList()},error:e=>{this._oWizard.destroy();this._navToWorkList()}})},_readQuestionsSet:function(e){var t="/QuestionSet",r={$expand:"Qtype,Form,Form/Icon"},s=[new a({filters:[new a("Deleted",u.EQ,"false"),new a("FormId",u.EQ,parseInt(e,10))],and:true})];n.readData(this.getModel(),t,r,s).then(e=>{var t=e.results;this._oViewModel.setProperty("/icon",t.length?t[0].Form.Icon.Source:"sap-icon://survey");this._oViewModel.setProperty("/FilteredQuestions",t);var n=[];for(var r=0;r<t.length;r++){n.push(t[r].Id)}this._getPossibleAnswerSet(n)}).fail(()=>{this.stopAppBusy();return})},_bindView:function(e){this.getView().bindElement({path:e,parameters:{expand:"Form, User"},events:{dataRequested:()=>{this.startAppBusy()},dataReceived:()=>{this.stopAppBusy()}}})},_getPossibleAnswerSet:function(e){if(!e||e.length===0){return}var t=[];for(var r=0;r<e.length;r++){t.push(new a("QuestionId",u.EQ,e[r]))}var s=[new a({filters:[new a("Deleted",u.EQ,"false"),new a({filters:t,and:false})],and:true})],o=this.getModel();n.readData(o,"/OptionSet",{},s).then(t=>{this.byId("idContainer").removeAllItems();if(this._oWizard){this._oWizard.destroy()}this._oViewModel.setProperty("/PossibleAnswers",t.results);if(this._oViewModel.getProperty("/isSurveyFinished")){this._getAnswerSetForUser(e)}else{this._buildWizardForOpenSurvey()}})},_buildWizardForOpenSurvey:function(){var e=this.byId("idVerticalLayout");this._oWizard=new s({finishButtonText:this.getResourceBundle().getText("btnSave"),complete:this.onPressCompleteWizard.bind(this)});e.addContent(this._oWizard);this._buildWizardStepsForOpenQuestions()},_getAnswerSetForUser:function(e){if(!e||e.length===0){return}var t=[];for(var r=0;r<e.length;r++){t.push(new a("QuestionId",u.EQ,e[r]))}var s="/AnswerSet",o=this.getModel(),i=[new a({filters:[new a("UserId",u.EQ,this._oViewModel.getProperty("/userID")),new a({filters:t,and:false})],and:true})],l={$expand:"User, Option, Question, Question/Qtype"};this.startAppBusy();n.readData(o,s,l,i).then(e=>{this._oViewModel.setProperty("/UserAnswers",e.results);this._buildFormForFinishedSurveys()}).fail(()=>{this.stopAppBusy()})},_buildFormForFinishedSurveys:function(){var e=this.byId("idContainer"),t=this._oViewModel.getProperty("/FilteredQuestions"),n=r.sortDataStructure(t),s=this._oViewModel.getProperty("/UserAnswers");for(var o=0;o<n.length;o++){var i=n[o].Qtype.Ui5Class,a=n[o].Mandatory,u=[],l=-1,d=this._extractAnswersForQuestion(n[o],s),f=this._extractMatchingOptionsWithQuestion(n[o].Id),p=r.sortDataStructure(f);for(var h=0;h<p.length;h++){var g=p[h],v=this._isOptionSelected(d,g.Id),T;if(i===m._CHECKBOX){T=this._generateNewCheckBoxControl(g.Answer,v,false);u.push(T)}if(i===m._RADIOBUTTON){T=this._generateNewRadioButtonControl(g.Answer,v,false);u.push(T)}if(i===m._RADIOBUTTON&&h===p.length-1){for(var y=0;l<0&&y<u.length;y++){if(u[y].sID===T.sID&&u[y].getSelected()){l=y}}}}if(u.length===0){var S=[],_;for(h=0;h<p.length;h++){for(y=0;y<d.length;y++){if(d[y].OptionId===p[h].Id){_=p[h].Id;break}}S.push(new c({key:p[h].Id,text:p[h].Answer}))}if(i===m._SELECT){u.push(this._generateNewSelectForFinishedSurvey(_,S))}else{var w;if(d.length===1){w=d[0].Answer}var x=r.generateParametersForControl(i,w,false,this);var I=r.generateNewControl(i,x,undefined,undefined,a);u.push(I)}}var b;if(i===m._RADIOBUTTON){b=this._generateNewRadioButtonGroup(u,l)}else{b=this._generateNewVBox(u)}b.addStyleClass("sapUiLargeMarginBegin");e.addItem(r.generateNewPanel(o+1,n[o].Question,[b]))}this.stopAppBusy()},_extractAnswersForQuestion:function(e,t){var n=[];for(var r=0;r<t.length;r++){if(t[r].QuestionId===e.Id){n.push(t[r])}}return n},_extractMatchingOptionsWithQuestion:function(e){var t=this._oViewModel.getProperty("/PossibleAnswers"),n=[];for(var r=0;r<t.length;r++){if(t[r].QuestionId===e){n.push(t[r])}}return n},_isOptionSelected:function(e,t){for(var n=0;n<e.length;n++){if(e[n].OptionId===t){return true}}return false},_buildWizardStepsForOpenQuestions:function(){var e=[],t=this._oViewModel.getProperty("/PossibleAnswers"),n=this._oViewModel.getProperty("/FilteredQuestions"),s=r.sortDataStructure(n);this._oDataModel=[];this._aQuestions=s;for(var o=0;o<s.length;o++){e=[];var i=s[o],a=i.Mandatory,u=i.Id,l=i.Qtype.Ui5Class,d=i.Regex,f=this._extractMatchingOptionsWithQuestion(u),p=-1,h=r.sortDataStructure(f);for(var g=0;g<h.length;g++){var v=h[g].DefaultAnswer?true:false,T=h[g].Answer,y;if(l===m._CHECKBOX){y=this._generateNewCheckBoxControl(T,v,true);this._addCustomDataForControl(y,u,"ID");this._addCustomDataForControl(y,h[g].Id,"subItems");e.push(y);if(a){y.attachSelect(this.onSelectCheckBox.bind(this))}}if(l===m._RADIOBUTTON){y=this._generateNewRadioButtonControl(T,v,true);this._addCustomDataForControl(y,u,"ID");this._addCustomDataForControl(y,h[g].Id,"subItems");e.push(y);if(a){y.attachSelect(this.onSelectRadioButton.bind(this))}for(var S=0;v&&S<e.length&&p<0;S++){p=e[S].sID===y.sID?S:-1}}}if(e.length===0){var _=[],w=[],x=[],I;for(g=0;g<t.length;g++){if(t[g].QuestionId===u){_.push(t[g])}}w=r.sortDataStructure(_);for(g=0;g<w.length;g++){if(w[g].DefaultAnswer){I=w[g].Id}x.push(new c({key:w[g].Id,text:w[g].Answer}))}if(l===m._SELECT){this._addCustomDataForControl(this._generateNewSelectControl(I,x),u,"ID");e.push(this._generateNewSelectControl(I,x))}else{var b=r.generateParametersForControl(l,undefined,true,this),C=r.generateNewControl(l,b,d,this._oWizard,i.Mandatory);if(a){this._manageMandatoryForControl(C,l)}this._addCustomDataForControl(C,u,"ID");e.push(C)}}var N;if(l===m._RADIOBUTTON){if(!a){e.push(this._generateNewRadioButtonControl(this.getResourceBundle().getText("btnRadioNone"),false,true))}N=this._generateNewRadioButtonGroup(e,p)}else{N=this._generateNewVBox(e)}this._oWizard.addStep(this._generateNewWizardStep(N,i.Question));this._oDataModel.push(this._generateOptionObject(null,u,l===m._CHECKBOX))}if(s.length>0&&s[0].Mandatory){var O=s[0].Qtype.Ui5Class;if(O===m._RATINGINDICATOR||O===m._SWITCH){this._oWizard.setShowNextButton(true)}else if(O===m._RADIOBUTTON){this._getStepContentAndChecksStatus(true,O)}else{this._getStepContentAndChecksStatus(false,O)}}this.stopAppBusy()},_getStepContentAndChecksStatus:function(e,t){this._oWizard.setShowNextButton(false);var n=this._oWizard.getSteps()[0],r=n.getAggregation("content")[0],s=e?r.getButtons():r.getItems();for(var o=0;o<s.length;o++){if(s[o]&&this._isControlHavingValue(s[o],t)){this._oWizard.setShowNextButton(true);break}}},_isControlHavingValue:function(e,t){switch(t){case m._RATINGINDICATOR:case m._INPUT:case m._TEXTAREA:return e.getValue()?true:false;case m._RADIOBUTTON:case m._CHECKBOX:return e.getSelected()?true:false;case m._SELECT:return e.getEnabled()?true:false;case m._SWITCH:return true}return false},_manageMandatoryForControl:function(e,t){if(t===m._TEXTAREA||t===m._INPUT){e.attachLiveChange(this.onLiveChangeInput.bind(this))}else if(t===m._RATINGINDICATOR){this._oWizard.setShowNextButton(true)}},_generateNewRadioButtonGroup:function(e,t){return new p({buttons:e,selectedIndex:t})},_generateNewVBox:function(e){return new h({items:e})},_generateNewWizardStep:function(e,t){return new g({content:[e],title:t,complete:this.onCompleteStepInWizard.bind(this)})},_generateNewCheckBoxControl:function(e,t,n){return r.generateNewControl(m._CHECKBOX,{text:e,editable:n,selected:t,fieldGroupIds:n?"fieldGroupSurvey":""},undefined,undefined,false)},_generateNewRadioButtonControl:function(e,t,n){return r.generateNewControl(m._RADIOBUTTON,{text:e,editable:n,selected:t,fieldGroupIds:n?"fieldGroupSurvey":""},undefined,undefined,false)},_generateNewSelectControl:function(e,t){return r.generateNewControl(m._SELECT,{selectedKey:e,editable:true,items:t,fieldGroupIds:"fieldGroupSurvey"},undefined,undefined,false)},_generateNewSelectForFinishedSurvey:function(e,t){return r.generateNewControl(m._SELECT,{selectedKey:e,editable:false,items:t},undefined,undefined,false)},_addCustomDataForControl:function(e,t,n){e.addCustomData(new d({key:n,value:t}))},_navToWorkList:function(){this.getRouter().navTo("worklist",{},true)}})})},"com/mjzsoft/Survey/controller/Worklist.controller.js":function(){sap.ui.define(["./BaseController","../model/formatter","../utils/Utils","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","../model/individualFormatter"],function(e,t,n,r,s,o,i){"use strict";return e.extend("com.mjzsoft.Survey.controller.Worklist",{formatter:t,onInit:function(){this._initViewModel();this.getRouter().getRoute("worklist").attachPatternMatched(this._onObjectMatched,this)},onPress:function(e){var t=e.getSource().getBindingContext().getObject(),n=t.FormId,r=e.getSource(),a=new s("FormId",o.EQ,n);if(e.getSource().getTileContent()[0].getFooterColor()==="Error"){i.show(this.getResourceBundle().getText("MsgInvalid"));return}this.startAppBusy();this._readQuestionsForUsers(a,r)},onNavBack:function(){history.go(-1)},onFormsRequested:function(){this.startAppBusy()},onFormsReceived:function(e){var t=e.getSource(),n=t.getFilterInfo();if(n.type==="Logical"){this.stopAppBusy()}},_onObjectMatched:function(e){this._readUserSurveySet()},_initViewModel:function(){this._oViewModel=this._initWorklistViewModel();this.setModel(this._oViewModel,"viewModel")},_initWorklistViewModel:function(){return new r({dialogBusy:true,flexBoxVisible:false,imageUrl:"",UserName:""})},_readQuestionsForUsers:function(e,t){n.readData(this.getModel(),"/QuestionSet",{},[e]).then(e=>{if(e.results.length<1){var n=this.getResourceBundle();i.show(n.getText("msgNoQuestions"));this.stopAppBusy()}else{this._navigateToObjectFromWorklist(t)}}).fail(()=>{this.stopAppBusy()})},_navigateToObjectFromWorklist:function(e){var t=e.getTileContent()[0].getFooter(),n=e.getBindingContext(),r=n.getProperty("FormId"),s=n.getProperty("UserId"),o=n.getProperty("Id"),i=0;if(this.getResourceBundle().getText("statusFinish")===t){i=1}this.getRouter().navTo("object",{objectId:r,finished:i,userID:s,sUserSurveyID:o})},_filterFlexBoxes:function(e){var t=[new s({filters:[new s("UserId",o.EQ,e),new s("Form/Deleted",o.EQ,false)],and:true})];this.byId("flexBox").getBinding("items").filter(t,"Application")},_updateView:function(){var e=this.getOwnerComponent().getCurrentUser();this._oViewModel.setProperty("/UserName",e.firstName+" "+e.lastName);this._oViewModel.setProperty("/flexBoxVisible",true);this._filterFlexBoxes(e.id)},_readUserSurveySet:function(){var e=this.getModel(),t=this.getOwnerComponent().getCurrentUser(),r="/SurveySet",i={$expand:"Form, User"},a=new s({filters:[new s("UserId",o.EQ,t.id),new s("Form/Deleted",o.EQ,false)],and:true});this.startAppBusy();n.readData(e,r,i,[a]).then(e=>{var t=e.results;this._readFormSet(t)}).fail(()=>{this.stopAppBusy()})},_readFormSet:function(e){var t=this.getModel(),r="/FormSet",i=new s({filters:[new s("Universal",o.EQ,true),new s("Deleted",o.EQ,false)],and:true});this.iNumberOfDoneRequests=0;n.readData(t,r,{},[i]).then(t=>{this._createPropertiesForSurvey(t.results,e)}).fail(()=>{this.stopAppBusy()})},_createPropertiesForSurvey:function(e,t){var n=this.getOwnerComponent(),r=n.getCurrentUser(),s="mjzsoftadd1"+(new Date).getTime(),o;for(var i=0;i<e.length;i++){var a=e[i],u=a.ValidTo,l=new Date,d=true;for(var c=0;c<t.length;c++){if(a.Id===t[c].Form.Id){d=false;break}}if(l>u){d=false}if(d){o={FormId:a.Id,UserId:""+r.id};this.iNumberOfDoneRequests++;this._createRequestForAssigningMissingSuervey(o,s)}}if(this.iNumberOfDoneRequests===0){this._updateView()}},_createRequestForAssigningMissingSuervey:function(e,t){var n=this.getModel();n.create("/SurveySet",e,{groupId:t,success:(e,t)=>{this.iNumberOfDoneRequests--;if(this.iNumberOfDoneRequests===0){this._updateView()}},error:e=>{this.iNumberOfDoneRequests--;this.stopAppBusy()}})}})})},"com/mjzsoft/Survey/i18n/i18n.properties":"#~~~ General ~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n#XTIT: Application name\nappTitle=Survey\n\n#YDES: Application description\nappDescription=Do your surveys\n\n#XTIT: Title of the worklist\nOverviewSurvey=Overview of all surveys for\n\n#YMSG: Message after user finished the survey\nSuccess=Successfully Finsished\n\n#XTIT: Title of save dialog\ntitleSaveDialog=Save\n\n#YMSG: Message of save confirmation dialog\ntxtDialogAdd=Are you sure you want to save?\n\n#XTIT: Title of valid from date\ntxtValidFrom=Valid from:\n\n#XTIT: Title of valid to date\ntxtValidTo=Valid to:\n\n#XTIT: Title of done at date\ntxtFinishedAt=Finished at:\n\n#XTIT: Title of valid from date\ntxtOpensAt=Opens at:\n\n#XTIT: Title of valid to date\ntxtClosedAt=Closed at:\n\n#YMSG: Validation message for mandatory input filed and text area\ntxtValueState=Please add at least 3 character\n\n#XTIT: Title of save button\nbtnSave=Save\n\n#XTIT: Title of Reject button\nbtnNo=No\n\n#XTIT: Title of Accept button\nbtnYes=Yes\n\n#YMSG: Message when the survey has no question \nmsgNoQuestions=There are no question for this survey.\n\n#XTIT: Title of review page\ntitObjectHeader=Reviewing your responses for the following survey\n\n#XTIT: Status of closed surveys\nstatusInvalid=Closed\n\n#XTIT: Status of opened surveys\nstatusOpen=Open\n\n#XTIT: Status of not yet opened surveys\nstatusNotOpenYet=Not yet opened or expired\n\n#XTIT: Status of closed surveys\nstatusFinish=Finished\n\n#XTXT: survey state 'unknown'\nstateUnknown=Unknown\n\n#YMSG: Message for closed surveys with no answer\nMsgInvalid=Survey already expired\n\n#XTIT: Title for radio button with value null\nbtnRadioNone=None\n\n#XLNK: text for link in 'not found' pages\nbackToWorklist=Show Survey\n\n#~~~ Not Found View ~~~~~~~~~~~~~~~~~~~~~~~\n\n#XTIT: Object page title\nobjectTitle=No Survey found\n\n#XTIT: Not found view title\nnotFoundTitle=Not Found\n\n#YMSG: The User_SurveysSet not found text is displayed when there is no User_SurveysSet with this id\nnoObjectFoundText=This Surveys is not available\n\n#YMSG: The not found text is displayed when there was an error loading the resource (404 error)\nnotFoundText=The requested survey was not found\n\n#~~~ Error Handling ~~~~~~~~~~~~~~~~~~~~~~~\n\n#XTIT: Header for error message box \nerror400TypeResponse=Bad request\n\n#XTIT: Header for error message box \nerrorResponse=Connection problems with the server\n\n#YMSG: Error dialog description\nerrorText=Sorry, a technical error occurred! Please try again later.","com/mjzsoft/Survey/i18n/i18n_de.properties":"#~~~ General ~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n#XTIT: Application name\nappTitle=Survey\n\n#YDES: Application description\nappDescription=Frageb\\u00f6gen beantworten\n\n#XTIT: Title of the worklist\nOverviewSurvey=\\u00dcbersicht aller Umfragen f\\u00fcr\n\n#YMSG: Message after user finished the survey\nSuccess=Efolgreich abgeschlossen\n\n#XTIT: Title of save dialog\ntitleSaveDialog=Speichern\n\n#YMSG: Message of save confirmation dialog\ntxtDialogAdd=Wirklich speichern?\n\n#XTIT: Title of valid from date\ntxtValidFrom=G\\u00fcltig von:\n\n#XTIT: Title of valid to date\ntxtValidTo=G\\u00fcltig bis:\n\n#XTIT: Title of done at date\ntxtFinishedAt=Abgeschlossen am:\n\n#XTIT: Title of valid from date\ntxtOpensAt=G\\u00fcltig ab:\n\n#XTIT: Title of valid to date\ntxtClosedAt=Geschlossen am:\n\n#YMSG: Validation message for mandatory input filed and text area\ntxtValueState=Bitte mindestens drei Zeichen eingeben\n\n#XTIT: Title of save button\nbtnSave=Speichern\n\n#XTIT: Title of Reject button\nbtnNo=Nein\n\n#XTIT: Title of Accept button\nbtnYes=Ja\n\n#YMSG: Message when the survey has no question \nmsgNoQuestions=Es gibt keine Fragen f\\u00fcr diesen Fragebogen\n\n#XTIT: Title of review page\ntitObjectHeader=\\u00dcbersicht der Antworden f\\u00fcr folgenden Fragebogen\n\n#XTIT: Status of closed surveys\nstatusInvalid=Abgeschlossen\n\n#XTIT: Status of opened surveys\nstatusOpen=Offen\n\n#XTIT: Status of not yet opened surveys\nstatusNotOpenYet=Noch nicht offen oder abgelaufen\n\n#XTIT: Status of closed surveys\nstatusFinish=Abgeschlossen\n\n#XTXT: survey state 'unknown'\nstateUnknown=Unbekannt\n\n#YMSG: Message for closed surveys with no answer\nMsgInvalid=Fragebogen ist abgelaufen\n\n#XTIT: Title for radio button with value null\nbtnRadioNone=None\n\n#XLNK: text for link in 'not found' pages\nbackToWorklist=Fragebogen zeigen\n\n#~~~ Not Found View ~~~~~~~~~~~~~~~~~~~~~~~\n\n#XTIT: Object page title\nobjectTitle=Fragebogen nicht gefunden\n\n#XTIT: Not found view title\nnotFoundTitle=Nicht gefunden\n\n#YMSG: The User_SurveysSet not found text is displayed when there is no User_SurveysSet with this id\nnoObjectFoundText=Dieser Fragebogen ist nicht verf\\u00fcgbar\n\n#YMSG: The not found text is displayed when there was an error loading the resource (404 error)\nnotFoundText=Der angeforderte Fragebogen wurde nicht gefunden\n\n#~~~ Error Handling ~~~~~~~~~~~~~~~~~~~~~~~\n\n#XTIT: Header for error message box \nerror400TypeResponse=Schlechter Request\n\n#XTIT: Header for error message box \nerrorResponse=Verbindungsprobleme mit dem Server\n\n#YMSG: Error dialog description\nerrorText=Sorry, ein technisches Problem ist aufgetreten!","com/mjzsoft/Survey/i18n/i18n_en.properties":"#~~~ General ~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n#XTIT: Application name\nappTitle=Survey\n\n#YDES: Application description\nappDescription=Do your surveys\n\n#XTIT: Title of the worklist\nOverviewSurvey=Overview of all surveys for\n\n#YMSG: Message after user finished the survey\nSuccess=Successfully Finsished\n\n#XTIT: Title of save dialog\ntitleSaveDialog=Save\n\n#YMSG: Message of save confirmation dialog\ntxtDialogAdd=Are you sure you want to save?\n\n#XTIT: Title of valid from date\ntxtValidFrom=Valid from:\n\n#XTIT: Title of valid to date\ntxtValidTo=Valid to:\n\n#XTIT: Title of done at date\ntxtFinishedAt=Finished at:\n\n#XTIT: Title of valid from date\ntxtOpensAt=Opens at:\n\n#XTIT: Title of valid to date\ntxtClosedAt=Closed at:\n\n#YMSG: Validation message for mandatory input filed and text area\ntxtValueState=Please add at least 3 character\n\n#XTIT: Title of save button\nbtnSave=Save\n\n#XTIT: Title of Reject button\nbtnNo=No\n\n#XTIT: Title of Accept button\nbtnYes=Yes\n\n#YMSG: Message when the survey has no question \nmsgNoQuestions=There are no question for this survey.\n\n#XTIT: Title of review page\ntitObjectHeader=Reviewing your responses for the following survey\n\n#XTIT: Status of closed surveys\nstatusInvalid=Closed\n\n#XTIT: Status of opened surveys\nstatusOpen=Open\n\n#XTIT: Status of not yet opened surveys\nstatusNotOpenYet=Not yet opened or expired\n\n#XTIT: Status of closed surveys\nstatusFinish=Finished\n\n#XTXT: survey state 'unknown'\nstateUnknown=Unknown\n\n#YMSG: Message for closed surveys with no answer\nMsgInvalid=Survey already expired\n\n#XTIT: Title for radio button with value null\nbtnRadioNone=None\n\n#XLNK: text for link in 'not found' pages\nbackToWorklist=Show Survey\n\n#~~~ Not Found View ~~~~~~~~~~~~~~~~~~~~~~~\n\n#XTIT: Object page title\nobjectTitle=No Survey found\n\n#XTIT: Not found view title\nnotFoundTitle=Not Found\n\n#YMSG: The User_SurveysSet not found text is displayed when there is no User_SurveysSet with this id\nnoObjectFoundText=This Surveys is not available\n\n#YMSG: The not found text is displayed when there was an error loading the resource (404 error)\nnotFoundText=The requested survey was not found\n\n#~~~ Error Handling ~~~~~~~~~~~~~~~~~~~~~~~\n\n#XTIT: Header for error message box \nerror400TypeResponse=Bad request\n\n#XTIT: Header for error message box \nerrorResponse=Connection problems with the server\n\n#YMSG: Error dialog description\nerrorText=Sorry, a technical error occurred! Please try again later.","com/mjzsoft/Survey/js/XML2JSON.js":function(){sap.ui.define([],function(){"use strict";return{X2JS:function(e){
/*
			 Copyright 2011-2013 Abdulla Abdurakhmanov
			 Original sources are available at https://code.google.com/p/x2js/
			
			 Licensed under the Apache License, Version 2.0 (the "License");
			 you may not use this file except in compliance with the License.
			 You may obtain a copy of the License at
			
			 http://www.apache.org/licenses/LICENSE-2.0
			
			 Unless required by applicable law or agreed to in writing, software
			 distributed under the License is distributed on an "AS IS" BASIS,
			 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
			 See the License for the specific language governing permissions and
			 limitations under the License.
			 */
const t="1.2.0",n={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};var r=e||{};(function e(){if(r.escapeMode===undefined){r.escapeMode=true}r.attributePrefix=r.attributePrefix||"_";r.arrayAccessForm=r.arrayAccessForm||"none";r.emptyNodeForm=r.emptyNodeForm||"text";if(r.enableToStringFunc===undefined){r.enableToStringFunc=true}r.arrayAccessFormPaths=r.arrayAccessFormPaths||[];if(r.skipEmptyTextNodesForObj===undefined){r.skipEmptyTextNodesForObj=true}if(r.stripWhitespaces===undefined){r.stripWhitespaces=true}r.datetimeAccessFormPaths=r.datetimeAccessFormPaths||[];if(r.useDoubleQuotes===undefined){r.useDoubleQuotes=false}r.xmlElementsFilter=r.xmlElementsFilter||[];r.jsonPropertiesFilter=r.jsonPropertiesFilter||[];if(r.keepCData===undefined){r.keepCData=false}})();function s(e){var t=e.localName;if(t===null){t=e.baseName}if(t===null||t===""){t=e.nodeName}return t}function o(e){return e.prefix}function i(e){if(typeof e==="string"){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}else{return e}}function a(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")}function u(e,t,n,r){for(var s=0;s<e.length;s++){var o=e[s];if(typeof o==="string"){if(o===r){break}}else if(o instanceof RegExp){if(o.test(r)){break}}else if(typeof o==="function"){if(o(t,n,r)){break}}}return s!==e.length}function l(e,t,n){if(r.arrayAccessForm==="property"){if(!(e[t]instanceof Array)){e[t+"_asArray"]=[e[t]]}else{e[t+"_asArray"]=e[t]}}if(!(e[t]instanceof Array)&&r.arrayAccessFormPaths.length>0){if(u(r.arrayAccessFormPaths,e,t,n)){e[t]=[e[t]]}}}function d(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");n.setHours(t[3],t[4],r[0]);if(r.length>1){n.setMilliseconds(r[1])}if(t[6]&&t[7]){var s=t[6]*60+Number(t[7]);var o=/\d\d-\d\d:\d\d$/.test(e)?"-":"+";s=0+(o==="-"?-1*s:s);n.setMinutes(n.getMinutes()-s-n.getTimezoneOffset())}else if(e.indexOf("Z",e.length-1)!==-1){n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()))}return n}function c(e,t,n){if(r.datetimeAccessFormPaths.length>0){var s=n.split(".#")[0];if(u(r.datetimeAccessFormPaths,e,t,s)){return d(e)}else{return e}}else{return e}}function f(e,t,s,o){if(t===n.ELEMENT_NODE&&r.xmlElementsFilter.length>0){return u(r.xmlElementsFilter,e,s,o)}else{return true}}function p(e,t){var i={},a,u,d;if(e.nodeType===n.DOCUMENT_NODE){a=e.childNodes;for(var h=0;h<a.length;h++){u=a.item(h);if(u.nodeType===n.ELEMENT_NODE){d=s(u);i[d]=p(u,d)}}return i}else if(e.nodeType===n.ELEMENT_NODE){i.__cnt=0;a=e.childNodes;for(h=0;h<a.length;h++){u=a.item(h);d=s(u);if(u.nodeType===n.COMMENT_NODE){continue}var g=t+"."+d;if(f(i,u.nodeType,d,g)){i.__cnt++;if(i[d]===null){i[d]=p(u,g);l(i,d,g)}else{if(i[d]!==null&&!(i[d]instanceof Array)){i[d]=[i[d]];l(i,d,g)}i[d][i[d].length]=p(u,g)}}}for(h=0;h<e.attributes.length;h++){var m=e.attributes.item(h);i.__cnt++;i[r.attributePrefix+m.name]=m.value}var v=o(e);if(v!==null&&v!==""){i.__cnt++;i.__prefix=v}if(i["#text"]!==null){i.__text=i["#text"];if(i.__text instanceof Array){i.__text=i.__text.join("\n")}if(r.stripWhitespaces){i.__text=i.__text.trim()}delete i["#text"];if(r.arrayAccessForm==="property"){delete i["#text_asArray"]}i.__text=c(i.__text,d,t+"."+d)}if(i["#cdata-section"]!==null){i.__cdata=i["#cdata-section"];delete i["#cdata-section"];if(r.arrayAccessForm==="property"){delete i["#cdata-section_asArray"]}}if(i.__cnt===0&&r.emptyNodeForm==="text"){i=""}else if(i.__cnt===1&&i.__text!==null){i=i.__text}else if(i.__cnt===1&&i.__cdata!==null&&!r.keepCData){i=i.__cdata}else if(i.__cnt>1&&i.__text!==null&&r.skipEmptyTextNodesForObj){if(r.stripWhitespaces&&i.__text===""||i.__text.trim()===""){delete i.__text}}delete i.__cnt;if(r.enableToStringFunc&&(i.__text!==null||i.__cdata!==null)){i.toString=function(){return(this.__text!==null?this.__text:"")+(this.__cdata!==null?this.__cdata:"")}}return i}else if(e.nodeType===n.TEXT_NODE||e.nodeType===n.CDATA_SECTION_NODE){return e.nodeValue}return i}function h(e,t,n,s){var o="<"+(e!==null&&e.__prefix!==null?e.__prefix+":":"")+t;if(n!==null){for(var a=0;a<n.length;a++){var u=n[a];var l=e[u];if(r.escapeMode){l=i(l)}o+=" "+u.substr(r.attributePrefix.length)+"=";if(r.useDoubleQuotes){o+='"'+l+'"'}else{o+="'"+l+"'"}}}if(s){o+="/>"}else{o+=">"}return o}function g(e,t){return"</"+(e.__prefix!==null?e.__prefix+":":"")+t+">"}function m(e,t){return e.indexOf(t,e.length-t.length)!==-1}function v(e,t){if(r.arrayAccessForm==="property"&&m(t.toString(),"_asArray")||t.toString().indexOf(r.attributePrefix)===0||t.toString().indexOf("__")===0||e[t]instanceof Function){return true}else{return false}}function T(e){var t=0;if(e instanceof Object){for(var n in e){if(v(e,n)){continue}t++}}return t}function y(e,t,n){return r.jsonPropertiesFilter.length===0||n===""||u(r.jsonPropertiesFilter,e,t,n)}function S(e){var t=[];if(e instanceof Object){for(var n in e){if(n.toString().indexOf("__")===-1&&n.toString().indexOf(r.attributePrefix)===0){t.push(n)}}}return t}function _(e){var t="";if(e.__cdata!==null){t+="<![CDATA["+e.__cdata+"]]>"}if(e.__text!==null){if(r.escapeMode){t+=i(e.__text)}else{t+=e.__text}}return t}function w(e){var t="";if(e instanceof Object){t+=_(e)}else if(e!==null){if(r.escapeMode){t+=i(e)}else{t+=e}}return t}function x(e,t){if(e===""){return t}else{return e+"."+t}}function I(e,t){var n="";var r=T(e);if(r>0){for(var s in e){if(v(e,s)||t!==""&&!y(e,s,x(t,s))){continue}var o=e[s];var i=S(o);if(o===null||o===undefined){n+=h(o,s,i,true)}else if(o instanceof Object){if(o instanceof Array){n+=b(o,s,i,t)}else if(o instanceof Date){n+=h(o,s,i,false);n+=o.toISOString();n+=g(o,s)}else if(T(o)>0||o.__text!==null||o.__cdata!==null){n+=h(o,s,i,false);n+=I(o,x(t,s));n+=g(o,s)}else{n+=h(o,s,i,true)}}else{n+=h(o,s,i,false);n+=w(o);n+=g(o,s)}}}n+=w(e);return n}function b(e,t,n,r){var s="";if(e.length===0){s+=h(e,t,n,true)}else{for(var o=0;o<e.length;o++){s+=h(e[o],t,S(e[o]),false);s+=I(e[o],x(r,t));s+=g(e[o],t)}}return s}this.parseXmlString=function(e){var t=window.ActiveXObject||"ActiveXObject"in window;if(e===undefined){return null}var n;if(window.DOMParser){var r=new window.DOMParser;var s=null;if(!t){try{s=r.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){s=null}}try{n=r.parseFromString(e,"text/xml");if(s!==null&&n.getElementsByTagNameNS(s,"parsererror").length>0){n=null}}catch(e){n=null}}else{var o=e;if(e.indexOf("<?")===0){o=e.substr(e.indexOf("?>")+2)}n=new ActiveXObject("Microsoft.XMLDOM");n.async="false";n.loadXML(o)}return n};this.asArray=function(e){if(e===undefined||e===null){return[]}else{if(e instanceof Array){return e}else{return[e]}}};this.toXmlDateTime=function(e){if(e instanceof Date){return e.toISOString()}else{if(typeof e==="number"){return new Date(e).toISOString()}else{return null}}};this.asDateTime=function(e){if(typeof e==="string"){return d(e)}else{return e}};this.XML2JSON=function(e){return p(e)};this.XMLStr2JSON=function(e){var t=this.parseXmlString(e);if(t!==null){return this.XML2JSON(t)}else{return null}};this.JSON2XMLStr=function(e){return I(e,"")};this.JSON2XML=function(e){var t=this.JSON2XMLStr(e);return this.parseXmlString(t)};this.getVersion=function(){return t}}}})},"com/mjzsoft/Survey/js/jwtAuthApp.js":function(){sap.ui.define([],function(){"use strict";var e=null,t=[],n=jQuery.sap.storage(jQuery.sap.storage.Type.session),r=jQuery.sap.storage(jQuery.sap.storage.Type.local),s=function(t,n,s,o,i){var a=e;sap.ui.core.BusyIndicator.show(1e3);jQuery.ajax({type:t,contentType:"application/json; charset=utf-8",pathInfo:null,data:t==="POST"?JSON.stringify(s):s,url:r.get("JwtServerUrl")+n,headers:{Authorization:a},cache:false,async:false,success:function(e,t,n){sap.ui.core.BusyIndicator.hide();if(typeof o==="function"){o(e,t,n)}},error:function(e,t,n){sap.ui.core.BusyIndicator.hide();if(typeof i==="function"){i(e,t,n)}}})},o=function(e,t,n,r){s("GET",e,t,n,r)},i=function(){var e=n.get("CurrentToken");return e!==null?JSON.parse(e):null},a=function(n){var r=t[n];r.setHeaders({Authorization:e})},u=function(){for(var e in t){if(e){a(e)}}},l=function(e){var n=t[e];n.setHeaders({Authorization:null})},d=function(){var t=i();if(t!==null&&t.expireAt>(new Date).getTime()){var r=t.tokenType+t.accessToken;if(r!==e){e=r}}else{n.clear();e=null}u()};d();sap.ui.getCore().getEventBus().subscribe("JWT","jwtChanged",d,this);var c={hasSession:function(t){var r=i();if(r!==null&&r.expireAt>(new Date).getTime()){e=r.tokenType+r.accessToken;if(typeof t==="function"){t(true)}return true}else{n.clear();e=null;if(typeof t==="function"){t(false)}return false}},addModel:function(e,n){t[n]=e;a(n)},removeModel:function(e){if(t[e]!==undefined){l(e);delete t[e]}},getCurrentUser:function(){var e=null;if(this.hasSession()){var t=n.get("CurrentUser");if(t===null){o(r.get("JwtUserEndpoint"),null,function(t,r,s){n.put("CurrentUser",JSON.stringify(t));e=t})}else{e=JSON.parse(t)}}return e}};return c})},"com/mjzsoft/Survey/manifest.json":'{"_version":"1.12.0","sap.app":{"id":"com.mjzsoft.Survey","type":"application","i18n":"i18n/i18n.properties","title":"{{appTitle}}","description":"{{appDescription}}","applicationVersion":{"version":"1.0.0"},"resources":"resources.json","dataSources":{"mainService":{"uri":"../../odata.svc/","type":"OData","settings":{"odataVersion":"2.0","localUri":"localService/metadata.xml"}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"sap-icon://task","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"rootView":{"viewName":"com.mjzsoft.Survey.view.App","type":"XML","async":true,"id":"app"},"dependencies":{"minUI5Version":"1.71.0","libs":{}},"resources":{"css":[{"uri":"css/style.css"}]},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"com.mjzsoft.Survey.i18n.i18n"}},"":{"dataSource":"mainService","preload":true}},"routing":{"config":{"routerClass":"sap.m.routing.Router","viewType":"XML","viewPath":"com.mjzsoft.Survey.view","controlId":"app","controlAggregation":"pages","bypassed":{"target":["notFound"]},"async":true},"routes":[{"pattern":"","name":"worklist","target":["worklist"]},{"pattern":"User_SurveysSet/{objectId}/{finished}/{userID}/{sUserSurveyID}","name":"object","target":["object"]}],"targets":{"worklist":{"viewName":"Worklist","viewId":"worklist","viewLevel":1},"object":{"viewName":"Object","viewId":"object","viewLevel":2},"objectNotFound":{"viewName":"ObjectNotFound","viewId":"objectNotFound"},"notFound":{"viewName":"NotFound","viewId":"notFound"}}}},"sap.platform.hcp":{"uri":"webapp","_version":"1.1.0"}}',"com/mjzsoft/Survey/model/formatter.js":function(){sap.ui.define([],function(){"use strict";return{numberUnit:function(e){if(!e){return""}return parseFloat(e).toFixed(2)}}})},"com/mjzsoft/Survey/model/individualFormatter.js":function(){sap.ui.define(["sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t){"use strict";var n=function(n,r,s){var o=n.getObject().Form.__ref,i=r.getProperty("/"+o),a=false;for(var u=0;u<i.Questions.__list.length;u++){var l=i.Questions.__list[u],d=r.getProperty("/"+l);var c=r.bindList("/"+l+"/Answers",null,null,[new e({path:"UserId",operator:t.EQ,value1:s}),new e({path:"QuestionId",operator:t.EQ,value1:d.Id})]);if(c.getLength()>0){a=true;break}}return a};return{formatTileClosed:function(e,t,r,s){var o=this.getModel("i18n").getResourceBundle(),i="",a=r.toLocaleDateString(),u=r.toLocaleTimeString(),l=t.toLocaleDateString(),d=t.toLocaleTimeString();var c=new Date;if(c>r){return i+o.getText("txtClosedAt")+" "+a+", "+u}else if(t>c){return i+o.getText("txtOpensAt")+" "+l+", "+d}else{if(n(this.getBindingContext(),this.getModel(),s)){return o.getText("stateUnknown")}else{return i+o.getText("txtValidTo")+" "+a+", "+u}}},formatTileFooter:function(e,t,r,s){var o=this.getModel("i18n").getResourceBundle();if(e){return o.getText("statusFinish")}else{if(n(this.getBindingContext(),this.getModel(),s)){return o.getText("statusFinish")}}var i=new Date;if(i>r){return o.getText("statusInvalid")}else if(i<t){return o.getText("statusNotOpenYet")}else{return o.getText("statusOpen")}},formatTileState:function(e,t,r,s){if(e){return"Good"}else{if(n(this.getBindingContext(),this.getModel(),s)){return"Good"}}var o=new Date;if(o<t||o>r){return"Error"}else if(o>t){return"Critical"}return""}}},true)},"com/mjzsoft/Survey/model/models.js":function(){sap.ui.define(["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,t){"use strict";return{createDeviceModel:function(){var n=new e(t);n.setDefaultBindingMode("OneWay");return n}}})},"com/mjzsoft/Survey/utils/ControlHelper.js":function(){sap.ui.define(["sap/m/RatingIndicator","sap/m/Switch","sap/m/RadioButton","sap/m/CheckBox","sap/m/Input","sap/m/TextArea","sap/m/Select","sap/m/Panel"],function(e,t,n,r,s,o,i,a){"use strict";const u={_RATINGINDICATOR:"sap.m.RatingIndicator",_SWITCH:"sap.m.Switch",_RADIOBUTTON:"sap.m.RadioButton",_CHECKBOX:"sap.m.CheckBox",_INPUT:"sap.m.Input",_TEXTAREA:"sap.m.TextArea",_SELECT:"sap.m.Select"};return{generateNewControl:function(a,l,d,c,f){switch(a){case u._RATINGINDICATOR:var p;if(l.editable===false){p=new e("RATINGINDICATOR"+this.getRandomMathString(),l);return this.addStyleClassToRatingControl(p)}else{p=new e("RATINGINDICATOR"+this.getRandomMathString(),l);p.attachChange(this.onAttachChangeValue.bind(this));return p}case u._SWITCH:return new t("SWITCH"+this.getRandomMathString(),l);case u._RADIOBUTTON:return new n("RADIOBUTTON"+this.getRandomMathString(),l);case u._CHECKBOX:return new r("CHECKBOX"+this.getRandomMathString(),l);case u._INPUT:if(l.editable===false&&(!l.value||!l.value.length)){return null}else{var h=new s("INPUT"+this.getRandomMathString(),l);h.addStyleClass("mjzsoftTransparentBackground");if(d!==null&&d!==undefined){h.attachChange(function(){var e=h.getValue(),t="None";c.setShowNextButton(true);var n=new RegExp([d]);if(!e.match(n)){t="Error";c.setShowNextButton(false)}if(f===false&&e.length===0){t="None";c.setShowNextButton(true)}h.setValueState(t)})}return h}case u._TEXTAREA:if(l.editable===false&&(!l.value||!l.value.length)){return null}else if(l.editable===false&&(l.value||l.value.length)){var g=new o("TEXTAREA"+this.getRandomMathString(),l),m=g.getValue().length;g.addStyleClass("mjzsoftTransparentBackground");if(m<30){g.setRows(1)}else if(m<60){g.setRows(2)}else if(m<100){g.setRows(3)}else if(m<150){g.setRows(5)}return g}else{var v=new o("TEXTAREA"+this.getRandomMathString(),l);v.addStyleClass("mjzsoftTransparentBackground");return v}case u._SELECT:return new i("SELECT"+this.getRandomMathString(),l)}return null},getRelevantFields:function(e){var t,n,r,s=[];for(t=0;t<e.length;t++){n=e[t];r=n.getMetadata().getName();switch(r){case u._SWITCH:s.push(n);break;case u._RADIOBUTTON:s.push(n);break;case u._CHECKBOX:s.push(n);break;case u._INPUT:s.push(n);break;case u._TEXTAREA:s.push(n);break;case u._SELECT:s.push(n);break;case u._RATINGINDICATOR:s.push(n)}}return s},getRandomMathString:function(){return Math.random().toString()},addStyleClassToRatingControl:function(e){var t=parseInt(e.getValue(),0);e.removeStyleClass("redStar");e.removeStyleClass("orangeStar");e.removeStyleClass("yellowStar");e.removeStyleClass("lightGreenStar");e.removeStyleClass("darkGreenStar");if(t===1){e.addStyleClass("redStar")}else if(t===2){e.addStyleClass("orangeStar")}else if(t===3){e.addStyleClass("yellowStar")}else if(t===4){e.addStyleClass("lightGreenStar")}else if(t===5){e.addStyleClass("darkGreenStar")}return e},onAttachChangeValue:function(e){var t=e.getSource();this.addStyleClassToRatingControl(t)},generateParametersForControl:function(e,t,n,r){var s=r.getResourceBundle();switch(e){case u._RATINGINDICATOR:return{maxValue:5,value:t===undefined?0:parseFloat(t),fieldGroupIds:n?"fieldGroupSurvey":"",editable:n};case u._SWITCH:return{state:t==="1"?true:false,fieldGroupIds:n?"fieldGroupSurvey":"",enabled:n,customTextOff:s.getText("btnNo"),customTextOn:s.getText("btnYes")};case u._RADIOBUTTON:return{selected:t==="1"?true:false,fieldGroupIds:n?"fieldGroupSurvey":"",editable:n};case u._CHECKBOX:return{selected:t==="1"?true:false,fieldGroupIds:n?"fieldGroupSurvey":"",editable:n};case u._INPUT:return{value:t===undefined?"":t,fieldGroupIds:n?"fieldGroupSurvey":"",editable:n,enabled:n,width:"80%"};case u._TEXTAREA:return{value:t===undefined?"":t,fieldGroupIds:n?"fieldGroupSurvey":"",editable:n,enabled:n,width:"80%",growing:true,rows:10};case u._SELECT:return{enabled:t==="1"?true:false,editable:n,fieldGroupIds:n?"fieldGroupSurvey":""}}return null},generateNewPanel:function(e,t,n){return new a({headerText:e+". "+t,content:n})},sortDataStructure:function(e){if(e.length>0){return e.sort(function(e,t){if(e.Sequence<t.Sequence){return-1}if(e.Sequence>t.Sequence){return 1}return 0})}else{return e}}}})},"com/mjzsoft/Survey/utils/Utils.js":function(){sap.ui.define(["sap/m/Dialog","sap/m/Text","sap/m/Button","sap/m/DialogType","sap/m/ButtonType"],function(e,t,n,r,s){"use strict";return{showDialog:function(o,i,a,u,l,d,c,f,p,h){var g=new e({title:i,type:r.Message,state:a,content:new t({text:u}),beginButton:new n({text:c,visible:f,width:d?"45%":"30%",press:function(){g.close();if(l===undefined){return}else{l()}},type:d?s.Accept:s.Default}),endButton:new n({text:p,visible:h,width:d?"45%":"30%",press:function(){g.close()},type:d?s.Reject:s.Default}),afterClose:function(){g.destroy()}});g.open();return g},readData:function(e,t,n,r){var s=jQuery.Deferred();e.read(t,{urlParameters:n,filters:r,success:s.resolve,error:s.reject});return s}}})},"com/mjzsoft/Survey/view/App.view.xml":'<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE xml><mvc:View controllerName="com.mjzsoft.Survey.controller.App" displayBlock="true" xmlns="sap.m" xmlns:mvc="sap.ui.core.mvc"><Shell><App id="app" busy="{appView>/busy}" busyIndicatorDelay="{appView>/delay}"/></Shell></mvc:View>',"com/mjzsoft/Survey/view/NotFound.view.xml":'<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE xml><mvc:View controllerName="com.mjzsoft.Survey.controller.NotFound" xmlns="sap.m" xmlns:mvc="sap.ui.core.mvc"><MessagePage title="{i18n>notFoundTitle}" text="{i18n>notFoundText}" icon="sap-icon://document" id="page" description=""><customDescription><Link id="link" text="{i18n>backToWorklist}" press=".onLinkPressed"/></customDescription></MessagePage></mvc:View>',"com/mjzsoft/Survey/view/Object.view.xml":'<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE xml><mvc:View controllerName="com.mjzsoft.Survey.controller.Object" xmlns="sap.m" xmlns:mvc="sap.ui.core.mvc" xmlns:semantic="sap.f.semantic"\n\txmlns:f="sap.ui.layout.form" xmlns:layout="sap.ui.layout" xmlns:core="sap.ui.core"><semantic:SemanticPage id="page" headerPinnable="false" toggleHeaderOnTitleClick="false" class="sapUiNoContentPadding"><semantic:titleHeading><VBox><HBox><VBox alignItems="Start" alignContent="SpaceAround"><Title visible="{= ${viewModel>/isSurveyFinished}}" text="{i18n>titObjectHeader}"/><VBox><HBox visible="{= ${viewModel>/isSurveyFinished} !== true }"><Label text="{i18n>txtValidFrom}" design="Bold"/><Label text="{ path:\'Form/ValidFrom\', type: \'sap.ui.model.type.DateTime\', formatOptions: { style: \'medium\' } }" class="sapUiTinyMarginBegin"/></HBox><HBox visible="{= ${viewModel>/isSurveyFinished} !== true }"><Label text="{i18n>txtValidTo}" design="Bold"/><Label text="{ path:\'Form/ValidTo\', type: \'sap.ui.model.type.DateTime\', formatOptions: { style: \'medium\' } }" class="sapUiTinyMarginBegin"/></HBox><HBox visible="{= ${viewModel>/isSurveyFinished}}"><Label text="{i18n>txtFinishedAt}" design="Bold"/><Label text="{ path:\'DoneAt\', type: \'sap.ui.model.type.DateTime\', formatOptions: { style: \'medium\' } }" class="sapUiTinyMarginBegin"/></HBox></VBox></VBox></HBox></VBox></semantic:titleHeading><semantic:headerContent class="sapUiNoContentPadding" pinnable="true"><ObjectHeader title="{Form/Name}" icon="{viewModel>/icon}"></ObjectHeader></semantic:headerContent><semantic:content><layout:VerticalLayout id="idVerticalLayout" width="100%"><VBox class="sapUiMediumMarginBegin" id="idContainer"></VBox></layout:VerticalLayout></semantic:content></semantic:SemanticPage></mvc:View>',"com/mjzsoft/Survey/view/ObjectNotFound.view.xml":'<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE xml><mvc:View\n\tcontrollerName="com.mjzsoft.Survey.controller.NotFound"\n\txmlns="sap.m"\n\txmlns:mvc="sap.ui.core.mvc"><MessagePage\n\t\ttitle="{i18n>objectTitle}"\n\t\ttext="{i18n>noObjectFoundText}"\n\t\ticon="sap-icon://product"\n\t\tdescription=""\n\t\tid="page"><customDescription><Link id="link" text="{i18n>backToWorklist}" press=".onLinkPressed" /></customDescription></MessagePage></mvc:View>',"com/mjzsoft/Survey/view/Worklist.view.xml":'<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE xml><mvc:View xmlns="sap.m" xmlns:mvc="sap.ui.core.mvc" xmlns:semantic="sap.f.semantic" controllerName="com.mjzsoft.Survey.controller.Worklist"\n\txmlns:layout="sap.ui.layout"><semantic:SemanticPage id="page" headerPinnable="false" toggleHeaderOnTitleClick="false" class="sapUiNoContentPadding"><semantic:titleHeading class="sapUiNoContentPadding"><Title text="{ parts: [{ path: \'i18n>OverviewSurvey\'}, {path: \'viewModel>/UserName\'}]}" level="H2"/></semantic:titleHeading><semantic:content><ScrollContainer id="scrollBar" class="myContainer" height="100%" width="100%" horizontal="true" vertical="true" focusable="true"><FlexBox wrap="Wrap" id="flexBox" visible="{viewModel>/flexBoxVisible}" direction="Row" justifyContent="Center"\n\t\t\t\t\titems="{ path: \'/SurveySet\', events: { dataRequested: \'.onFormsRequested\', dataReceived: \'.onFormsReceived\' }, filters: [{ path: \'UserId\', operator: \'EQ\', value1: \'0\' }], parameters: {expand: \'Form, User, Form/Icon,Form/Questions,Form/Questions/Answers\'}}"><GenericTile headerImage="{Form/Icon/Source}" class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout" press="onPress"\n\t\t\t\t\t\theader="{Form/Name}"><TileContent\n\t\t\t\t\t\t\tfooter="{ parts:[ { path: \'DoneAt\'}, {path: \'Form/ValidFrom\'}, {path: \'Form/ValidTo\'}, {path: \'UserId\'}], formatter: \'com.mjzsoft.Survey.model.individualFormatter.formatTileFooter\'}"\n\t\t\t\t\t\t\tfooterColor="{parts:[ { path: \'DoneAt\'}, {path: \'Form/ValidFrom\'}, {path: \'Form/ValidTo\'}, {path: \'UserId\'}], formatter: \'com.mjzsoft.Survey.model.individualFormatter.formatTileState\'}"><content><HBox><VBox visible="{=${DoneAt} !== null}"><Text\n\t\t\t\t\t\t\t\t\t\t\ttext="{parts:[{path: \'i18n>txtFinishedAt\'}, { path:\'DoneAt\', type: \'sap.ui.model.type.DateTime\', formatOptions: { style: \'medium\' }}] }"/></VBox><VBox visible="{=${DoneAt} === null}"><Text\n\t\t\t\t\t\t\t\t\t\t\ttext="{ parts: [ {path: \'i18n>txtOpensAt\'}, {path: \'Form/ValidFrom\'}, {path:\'Form/ValidTo\'}, {path: \'UserId\'}], formatter: \'com.mjzsoft.Survey.model.individualFormatter.formatTileClosed\'}"/></VBox></HBox></content></TileContent></GenericTile></FlexBox></ScrollContainer></semantic:content></semantic:SemanticPage></mvc:View>'}});