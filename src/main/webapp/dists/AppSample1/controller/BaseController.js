sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","com/mjzsoft/QuestionnaireBuilder/js/Validator"],function(e,t,i){"use strict";var n={"sap.m.Input":"value","sap.m.Select":"selectedKey","sap.m.CheckBox":"selected","sap.m.DatePicker":"dateValue","sap.m.DateTimePicker":"value","sap.m.TextArea":"value","sap.m.Switch":"state"};return e.extend("com.mjzsoft.QuestionnaireBuilder.controller.BaseController",{getRouter:function(){return this.getOwnerComponent().getRouter()},getModel:function(e){return this.getView().getModel(e)},getAppViewModel:function(){return this.getModel("appView")},setModel:function(e,t){return this.getView().setModel(e,t)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},onNavBack:function(){var e=t.getInstance().getPreviousHash(),i=sap.ushell.Container.getService("CrossApplicationNavigation");if(e!==undefined||!i.isInitialNavigation()){history.go(-1)}else{this.getRouter().navTo("master",{},true)}},bindOnChangeToInputs:function(e,t){var i=t?t.getControlsByFieldGroupId(e):this.getView().getControlsByFieldGroupId(e);if(i){for(var n=0;n<i.length;n++){if(typeof i[n].attachChange==="function"){i[n].attachChange(this.onInputChange,this)}}}},onInputChange:function(e){if(e){var t=e.getSource(),i=t.getBindingContext();if(i!==null){var o=function(e){var t=e.substring(1),i=e.charAt(0).toUpperCase(),n="get"+i+t;return n},r=t.getMetadata().getName(),a=i.getModel(),s=t.getBinding(n[r]).getPath(),l=s&&s.startsWith("/")?s.substring(1):s,u=i.getPath()+"/"+l,d=o(n[r]),g=t[d]();if(t.getBindingContext()){if(r==="sap.m.DatePicker"){if(g){a.setProperty(u,new Date(g))}else{a.setProperty(u,null)}}else if(r==="sap.m.DateTimePicker"){if(g){a.setProperty(u,new Date(t.getDateValue()))}else{a.setProperty(u,null)}}else{a.setProperty(u,g)}}}this._oValidator.validate(t)}},getFieldValueByType:function(e){var t=function(e){var t=e.substring(1),i=e.charAt(0).toUpperCase(),n="get"+i+t;return n},i=e.getMetadata().getName(),o=t(n[i]),r=e[o]();return r},initiateValidator:function(){this._oValidator=new i},resetAllValueStates:function(){if(!this._oValidator){this._oValidator=new i}this._oValidator.removeAllMessages()},getValidator:function(){if(!this._oValidator){this._oValidator=new i}return this._oValidator},objectCopier:function(e,t){for(var i in t){if(t[i]!==undefined){if(typeof t[i]==="object"&&!(t[i]instanceof Date)){if(!e[i]){e[i]={}}this.objectCopier(e[i],t[i])}else{if(typeof t[i]==="string"&&t[i].length>0){e[i]=t[i]}else if(typeof t[i]==="string"){delete e[i]}else if(t[i]!==undefined||t[i]!==null){e[i]=t[i]}else{delete e[i]}}}}},getBatchObject:function(e,t){var i=jQuery.extend({},e);delete i.__metadata;if(t==="Form"){delete i.Icon;delete i.Questions;delete i.Surveys;delete i.IconSrc}else if(t==="Question"){delete i.Answers;delete i.SourceConditions;delete i.TargetConditions;delete i.Form;delete i.Options;delete i.Qtype}else if(t==="Option"){delete i.Answers;delete i.Question}return i}})});